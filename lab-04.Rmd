---
title: "Lab 04 - Visualizing Spatial Data"
author: "Shatavia Bellmon"
date: "2/17/26"
output: github_document
---

### Load packages and data

```{r}
#install.packages("devtools")
#devtools::install_github("tidyverse/dsbox")
```



```{r load-packages, message = FALSE}
library(tidyverse)
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

??dennys

??laquinta

View(laquinta)

The Denny's dataset has `r nrow(dennys)` rows and `r ncol(dennys)` columns. Each row represents an individual Denny's location. The variables are address, city, state, zip, longitude, and latitude.

### Exercise 2
The La Quinta dataset has `r nrow(laquinta)` rows and `r ncol(laquinta)` columns. Each row represents the different locations of the La Quinta hotels. The variables are address, city, state, zip, longitude, and latitude.

### Exercise 3
There are La Quintas in Ecuador, Columbia, Dubai, Turkiye, Georgia, Australia, China, Mexico, and Canada. According to the website given, there are no Denny's outside the U.S.

### Exercise 4
One way to deteermine international locations would be to look at the state abbreviations of each location and see if it belongs to a U.S. state or not.



### Exercise 5
```{r}
dennys %>% 
  filter(!(state %in% states$abbreviation))
```

### Exercise 6

There are no dennys locations outide the U.S.

```{r}
dennys %>%
  mutate(country = "United States")
```


### Excercise 7

There are La Quintas in Ecuador, Columbia, Dubai, Turkiye, Georgia, Australia, China, Mexico, and Canada.

### Excercise 8

```{r}
lq <- laquinta


```

View(lq)

```{r}
lq <- lq %>%
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state == "FM" ~ "Honduras",
    state %in% c("AG", "CH", "NL", "PU", "QR", "SL", "VE") ~ "Mexico"
  ))
summary(factor(lq$country))
```

### Excercise 9

```{r}
lq <- lq %>%
  filter(country == "United States")
```

California has the most amount of dennys. Alaska, Montana, South Dakota, and Vermont had the fewest amounts of Dennys. This makes sense as California is the biggest state in the U.S., so more land equals more oppurtunity to build a dennys. The other states with only 1 dennys have many rural areas so it there is not a lot of business that can come from these states. 

Least: Mexico and Columbia
Most: California, Florida, Texas
This makes sense as California, Florida, and Texas are the states in the U.S. with the biggest populations, so more people equals more opportunity to have business. Mexico and Columbia probably have more culturally significant restaurants prevalent in their countries. 


```{r}
dn <- dennys
```

```{r}
dn %>% 
  count(state) %>% 
  inner_join(states, by = c("state" = "abbreviation"))
```


### Excercise 10

```{r}
dn <- dn %>%
  mutate(establishment = "Denny's")
lq <- lq %>%
  mutate(establishment = "La Quinta")
```

```{r}
dn_lq <- bind_rows(dn, lq)
```

```{r}
ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point()
```

### Excercise 11

```{r}
dn_nc <- dn %>% filter(state == "NC")
lq_nc <- lq %>% filter(state == "NC")
```

```{r}
ggplot() +
  geom_point(data = dn_nc, aes(x = longitude, y = latitude), 
             color = "red", alpha = 0.5, size = 2) +
  geom_point(data = lq_nc, aes(x = longitude, y = latitude), 
             color = "blue", alpha = 0.5, size = 2, shape = 17) +
  labs(title = "Denny's vs. La Quinta in North Carolina",
       subtitle = "Red = Denny's, Blue = La Quinta",
       x = "Longitude", y = "Latitude")
```
Mitch Hedberg’s joke does not appear to hold here, there are only a few places where there is a laquinta next to a Denny's

### Excercise 12

```{r}
dn_tx <- dn %>% filter(state == "TX")
lq_tx <- lq %>% filter(state == "TX")
```


```{r}
ggplot() +
  geom_point(data = dn_tx, aes(x = longitude, y = latitude), 
             color = "red", alpha = 0.3, size = 1.5) +
  geom_point(data = lq_tx, aes(x = longitude, y = latitude), 
             color = "blue", alpha = 0.3, size = 1.5, shape = 17) +
  labs(title = "Denny's vs. La Quinta in Texas",
       subtitle = "Red = Denny's, Blue = La Quinta",
       x = "Longitude", y = "Latitude")
```
Mitch Hedberg’s joke DEFENITELY appears to hold here!



